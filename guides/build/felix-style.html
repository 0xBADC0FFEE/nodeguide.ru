<div id="&#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1086;-&#1087;&#1086;-&#1089;&#1090;&#1080;&#1083;&#1102;-&#1082;&#1086;&#1076;&#1072;-&#1074;-node.js-&#1086;&#1090;-felixa"
><h1
  ><a href="#TOC"
    >Руководство по стилю кода в Node.js от Felix'a</a
    ></h1
  ><p
  >В настоящий момент не существует официального документа, который бы регламентировал стиль кода в node.js приложениях. Это руководство - моя попытка донести до читателя набор подходов, позволяющих создавать прекрасное и целостное ПО.</p
  ><p
  >Руководство предполагает, что читатель работает исключительно в node.js. Если предполагается запуск кода в браузере или каком-либо другом окружении, то некоторые пукнты текста можно игнорировать.</p
  ><p
  >Так же следует обратить внимание, что и node.js, и многие пакеты для него, имеют свои собственные соглашения о стиле кода, которые не всегда совпадают. Таким образом, если Вы собираетесь вносить клад в код какого-либо пакета, то следуйте соглашению о стиле этого пакета.</p
  ><div id="&#1090;&#1072;&#1073;&#1091;&#1083;&#1103;&#1094;&#1080;&#1103;-vs-&#1087;&#1088;&#1086;&#1073;&#1077;&#1083;&#1099;"
  ><h2
    ><a href="#TOC"
      >Табуляция vs Пробелы</a
      ></h2
    ><p
    >Начнем с религиозных проблем. Наш <a href="community.html#ryan-dahl"
      >великодушный диктатор</a
      > выбрал при разработке ядра node.js отступ в 2 пробела. Таким образом, было бы хорошо, если бы вы так же последовали его примеру.</p
    ></div
  ><div id="&#1090;&#1086;&#1095;&#1082;&#1072;-&#1089;-&#1079;&#1072;&#1087;&#1103;&#1090;&#1086;&#1081;"
  ><h2
    ><a href="#TOC"
      >Точка с запятой</a
      ></h2
    ><p
    >Есть <a href="community.html#isaac-schlueter"
      >мятежные силы</a
      >, которые пытаются украсть у вас точки с запятой. Но не совершайте ошибок! Наша традиционная культура все еще <a href="http://news.ycombinator.com/item?id=1547647"
      >живет</a
      >. Так что следуйте за сообществом и пользуйтесь точками с запятыми!</p
    ></div
  ><div id="&#1088;&#1077;&#1076;&#1072;&#1082;&#1090;&#1086;&#1088;&#1099;"
  ><h2
    ><a href="#TOC"
      >Редакторы</a
      ></h2
    ><p
    >Вы можете использовать любой редактор. Однако было бы удобно, чтобы он умел подсвечивать синтаксис JavaScript'a и выполнять в среде node.js редактируемый файл. <a href="http://www.vim.org/"
      >Vim</a
      >, конечно, не поможет вам впечатлить девушку, но зато он угодит нашему <a href="http://en.wikipedia.org/wiki/BDFL"
      >великодушному пожизненному диктатору</a
      > и ваш дедушка его тоже одобрит.</p
    ><p
    >Я пишу этот документ в Notes на моем iPad'e, но это все потому, что я сейчас нахожусь на пляже в Тайланде. Так что, вполне вероятно, что ваше собственное рабочее окружение повлияет на ваш выбор редактора.</p
    ></div
  ><div id="&#1082;&#1086;&#1085;&#1094;&#1077;&#1074;&#1099;&#1077;-&#1087;&#1088;&#1086;&#1073;&#1077;&#1083;&#1099;"
  ><h2
    ><a href="#TOC"
      >Концевые пробелы</a
      ></h2
    ><p
    >Точно так же, как вы чистите зубы после еды, вы должны подчищать конечные пробелы в ваших JavaScript файлах перед тем, как сделать коммит. Иначе гнилой запах небрежности и пренебрежения разгонить в итоге авторов и/или коллег.</p
    ></div
  ><div id="&#1076;&#1083;&#1080;&#1085;&#1085;&#1072;-&#1089;&#1090;&#1088;&#1086;&#1082;&#1080;"
  ><h2
    ><a href="#TOC"
      >Длинна строки</a
      ></h2
    ><p
    >Следует ограничивать строки 80-ю символами. Да, экраны за последние несколько лет стали больше, но ваш мозг не стал. Используйте дополнительное место для разбиения экрана. Ваш же редактор это позволяет, не так ли?</p
    ></div
  ><div id="&#1082;&#1072;&#1074;&#1099;&#1095;&#1082;&#1080;"
  ><h2
    ><a href="#TOC"
      >Кавычки</a
      ></h2
    ><p
    >Используйте одиночные кавычки везде, кроме случаев редактирования JSON.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> foo = <span class="st"
	>'</span
	><span class="ch"
	>bar'</span
	>;<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> foo = <span class="st"
	>&quot;bar&quot;</span
	>;<br
	 /></code
      ></pre
    ></div
  ><div id="&#1092;&#1080;&#1075;&#1091;&#1088;&#1085;&#1099;&#1077;-&#1089;&#1082;&#1086;&#1073;&#1082;&#1080;"
  ><h2
    ><a href="#TOC"
      >Фигурные скобки</a
      ></h2
    ><p
    >Располагайте открывающую скобку на той же линии, что и выражение.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>if</span
	> (<span class="kw"
	>true</span
	>) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>winning'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>if</span
	> (<span class="kw"
	>true</span
	>)<br
	 />{<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>losing'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ><p
    >Так же обратите внимание на использование пробела перед и после условного выражения.</p
    ></div
  ><div id="&#1086;&#1073;&#1098;&#1103;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;-&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1093;"
  ><h2
    ><a href="#TOC"
      >Объявление переменных</a
      ></h2
    ><p
    >Объявляйте по одной переменной с каждым ключевым словом var. Такой подход облегчает переупорядочивание строк. Не обращайте внимания на <a href="http://javascript.crockford.com/code.html"
      >Crockford</a
      >'a по этому поводу, и размещайте объявления там, где они имеют смысл.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> keys = [<span class="st"
	>'</span
	><span class="ch"
	>foo'</span
	>, <span class="st"
	>'</span
	><span class="ch"
	>bar'</span
	>];<br
	 /><span class="kw"
	>var</span
	> values = [<span class="dv"
	>23</span
	>, <span class="dv"
	>42</span
	>];<br
	 /><br
	 /><span class="kw"
	>var</span
	> object = {};<br
	 /><span class="kw"
	>while</span
	> (items.<span class="dt"
	>length</span
	>) {<br
	 />&#160;&#160;var key = keys.<span class="dt"
	>pop</span
	>();<br
	 />&#160;&#160;object[key] = values.<span class="dt"
	>pop</span
	>();<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> keys = [<span class="st"
	>'</span
	><span class="ch"
	>foo'</span
	>, <span class="st"
	>'</span
	><span class="ch"
	>bar'</span
	>],<br
	 /> &#160; &#160;values = [<span class="dv"
	>23</span
	>, <span class="dv"
	>42</span
	>],<br
	 /> &#160; &#160;object = {},<br
	 /> &#160; &#160;key;<br
	 /><br
	 /><span class="kw"
	>while</span
	> (items.<span class="dt"
	>length</span
	>) {<br
	 />&#160;&#160;key = keys.<span class="dt"
	>pop</span
	>();<br
	 />&#160;&#160;object[key] = values.<span class="dt"
	>pop</span
	>();<br
	 />}<br
	 /></code
      ></pre
    ></div
  ><div id="&#1080;&#1084;&#1077;&#1085;&#1072;-&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1093;-&#1080;-&#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;"
  ><h2
    ><a href="#TOC"
      >Имена переменных и свойств</a
      ></h2
    ><p
    >Переменные и свойства должны использовать <a href="http://en.wikipedia.org/wiki/camelCase#Variations_and_synonyms"
      >нижний верблюжий регистр</a
      > / <a href="http://ru.wikipedia.org/wiki/CamelCase"
      >рус</a
      >. Кроме того, они должны быть наглядными. Одиночных символов и необычных аббревиатур следует избегать.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> adminUser = db.query(<span class="st"
	>'</span
	><span class="ch"
	>SELECT * FROM users ...'</span
	>);<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> admin_user = d.query(<span class="st"
	>'</span
	><span class="ch"
	>SELECT * FROM users ...'</span
	>);<br
	 /></code
      ></pre
    ></div
  ><div id="&#1080;&#1084;&#1077;&#1085;&#1072;-&#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1074;"
  ><h2
    ><a href="#TOC"
      >Имена классов</a
      ></h2
    ><p
    >Имена классов должны использовать <a href="http://en.wikipedia.org/wiki/camelCase#Variations_and_synonyms"
      >верхний верблюжий регистр</a
      >.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>function</span
	> BankAccount() {<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>function</span
	> bank_Account() {<br
	 />}<br
	 /></code
      ></pre
    ></div
  ><div id="&#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1099;"
  ><h2
    ><a href="#TOC"
      >Константы</a
      ></h2
    ><p
    >Константы должны объявляться как обычные переменные или статические свойства классов. Все буквы должны быть в верхнем регистре.</p
    ><p
    >Node.js / V8 поддерживает расширение <a href="https://developer.mozilla.org/en/JavaScript/Reference/Statements/const"
      >const</a
      > от mozilla, но, к сожалению, оно не применимо к членам класса, равно как и часть любого стандарта ECMA.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> SECOND = <span class="dv"
	>1</span
	> * <span class="dv"
	>1000</span
	>;<br
	 /><br
	 /><span class="kw"
	>function</span
	> File() {<br
	 />}<br
	 />File.FULL_PERMISSIONS = <span class="dv"
	>0777</span
	>;<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>const</span
	> SECOND = <span class="dv"
	>1</span
	> * <span class="dv"
	>1000</span
	>;<br
	 /><br
	 /><span class="kw"
	>function</span
	> File() {<br
	 />}<br
	 />File.fullPermissions = <span class="dv"
	>0777</span
	>;&#160;<br
	 /></code
      ></pre
    ></div
  ><div id="&#1089;&#1086;&#1079;&#1076;&#1072;&#1085;&#1080;&#1077;-&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;-&#1084;&#1072;&#1089;&#1089;&#1080;&#1074;&#1072;"
  ><h2
    ><a href="#TOC"
      >Создание Объекта / Массива</a
      ></h2
    ><p
    >Используйте завершающие запятые и <em
      >короткие</em
      > обявления на одной строке. Ключи помещайте в кавычки только тогда, когда пожалуется интерпретатор.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> a = [<span class="st"
	>'</span
	><span class="ch"
	>hello'</span
	>, <span class="st"
	>'</span
	><span class="ch"
	>world'</span
	>];<br
	 /><span class="kw"
	>var</span
	> b = {<br
	 />&#160;&#160;good: <span class="st"
	>'</span
	><span class="ch"
	>code'</span
	>,<br
	 />&#160;&#160;<span class="st"
	>'</span
	><span class="ch"
	>is generally'</span
	>: <span class="st"
	>'</span
	><span class="ch"
	>pretty'</span
	>,<br
	 />};<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> a = [<br
	 />&#160;&#160;<span class="st"
	>'</span
	><span class="ch"
	>hello'</span
	>, <span class="st"
	>'</span
	><span class="ch"
	>world'</span
	><br
	 />];<br
	 /><span class="kw"
	>var</span
	> b = {<span class="st"
	>&quot;good&quot;</span
	>: <span class="st"
	>'</span
	><span class="ch"
	>code'</span
	><br
	 />&#160; &#160; &#160; &#160; , is generally: <span class="st"
	>'</span
	><span class="ch"
	>pretty'</span
	><br
	 />        };<br
	 /></code
      ></pre
    ></div
  ><div id="&#1086;&#1087;&#1077;&#1088;&#1072;&#1090;&#1086;&#1088;-&#1088;&#1072;&#1074;&#1077;&#1085;&#1089;&#1090;&#1074;&#1072;"
  ><h2
    ><a href="#TOC"
      >Оператор равенства</a
      ></h2
    ><p
    >Программирование - это вам не запоминание <a href="https://developer.mozilla.org/en/JavaScript/Reference/Operators/Comparison_Operators"
      >глупых правил</a
      >. Используйте тройной оператор равенства, так как только он будет работать так, как ожидается.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> a = <span class="dv"
	>0</span
	>;<br
	 /><span class="kw"
	>if</span
	> (a === <span class="st"
	>'</span
	><span class="ch"
	>'</span
	>) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>winning'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> a = <span class="dv"
	>0</span
	>;<br
	 /><span class="kw"
	>if</span
	> (a == <span class="st"
	>'</span
	><span class="ch"
	>'</span
	>) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>losing'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ></div
  ><div id="&#1088;&#1072;&#1089;&#1096;&#1080;&#1088;&#1077;&#1085;&#1080;&#1077;-&#1087;&#1088;&#1086;&#1090;&#1086;&#1090;&#1080;&#1087;&#1086;&#1074;"
  ><h2
    ><a href="#TOC"
      >Расширение прототипов</a
      ></h2
    ><p
    >Не расширяйте прототипы всех подряд объектов, особенно встроенных. В аду есть специальное место, в котором вас будут ждать, если вы не будете следовать этому правилу.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> a = [];<br
	 /><span class="kw"
	>if</span
	> (!a.<span class="dt"
	>length</span
	>) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>winning'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>Array</span
	>.<span class="dt"
	>prototype</span
	>.empty = <span class="kw"
	>function</span
	>() {<br
	 />&#160;&#160;return !<span class="kw"
	>this</span
	>.<span class="dt"
	>length</span
	>;<br
	 />}<br
	 /><br
	 /><span class="kw"
	>var</span
	> a = [];<br
	 /><span class="kw"
	>if</span
	> (a.empty()) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>losing'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ></div
  ><div id="&#1091;&#1089;&#1083;&#1086;&#1074;&#1080;&#1103;"
  ><h2
    ><a href="#TOC"
      >Условия</a
      ></h2
    ><p
    >Все нетривиальные условия должны присваиваться переменной.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> isAuthorized = (user.isAdmin() || user.isModerator());<br
	 /><span class="kw"
	>if</span
	> (isAuthorized) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>winning'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>if</span
	> (user.isAdmin() || user.isModerator()) {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>losing'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ></div
  ><div id="&#1088;&#1072;&#1079;&#1084;&#1077;&#1088;-&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1081;"
  ><h2
    ><a href="#TOC"
      >Размер функций</a
      ></h2
    ><p
    >Функции должны быть короткими. Хорошая функция должна помещаться на слайд, который будет хорошо читаться людми, сидящими на последнем ряду в большой комнате.</p
    ></div
  ><div id="&#1086;&#1087;&#1077;&#1088;&#1072;&#1090;&#1086;&#1088;-return"
  ><h2
    ><a href="#TOC"
      >Оператор return</a
      ></h2
    ><p
    >Возвращайте значение из функции как можно раньше. Тем самым будет исключаться большая вложенность if-else конструкций.</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>function</span
	> isPercentage(val) {<br
	 />&#160;&#160;if (val &lt; <span class="dv"
	>0</span
	>) {<br
	 />&#160;&#160; &#160;return <span class="kw"
	>false</span
	>;<br
	 />&#160;&#160;}<br
	 /><br
	 />&#160;&#160;if (val &gt; <span class="dv"
	>100</span
	>) {<br
	 />&#160;&#160; &#160;return <span class="kw"
	>false</span
	>;<br
	 />&#160;&#160;}<br
	 /><br
	 />&#160;&#160;return <span class="kw"
	>true</span
	>;<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>function</span
	> isPercentage(val) {<br
	 />&#160;&#160;if (val &gt;= <span class="dv"
	>0</span
	>) {<br
	 />&#160;&#160; &#160;if (val &lt; <span class="dv"
	>100</span
	>) {<br
	 />&#160;&#160; &#160; &#160;return <span class="kw"
	>true</span
	>;<br
	 />&#160;&#160; &#160;} <span class="kw"
	>else</span
	> {<br
	 />&#160;&#160; &#160; &#160;return <span class="kw"
	>false</span
	>;<br
	 />&#160;&#160; &#160;}<br
	 />&#160;&#160;} <span class="kw"
	>else</span
	> {<br
	 />&#160;&#160; &#160;return <span class="kw"
	>false</span
	>;<br
	 />&#160;&#160;}<br
	 />}<br
	 /></code
      ></pre
    ><p
    >Или для этого конкретного примера этот подход так же применим:</p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>function</span
	> isPercentage(val) {<br
	 />&#160;&#160;var isInRange = (val &gt;= <span class="dv"
	>0</span
	> &amp;&amp; val &lt;= <span class="dv"
	>100</span
	>);<br
	 />&#160;&#160;return&#160;isInRange;<br
	 />}<br
	 /></code
      ></pre
    ></div
  ><div id="&#1080;&#1084;&#1077;&#1085;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077;-&#1079;&#1072;&#1084;&#1099;&#1082;&#1072;&#1085;&#1080;&#1103;"
  ><h2
    ><a href="#TOC"
      >Именованные замыкания</a
      ></h2
    ><p
    >Не бойтесь давать замыканиям имена. Это показывает, что вы заботитесь о них. Результатом этой заботы будет более полная трассировка стека:</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      >req.on(<span class="st"
	>'</span
	><span class="ch"
	>end'</span
	>, <span class="kw"
	>function</span
	> onEnd() {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>winning'</span
	>);<br
	 />});<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      >req.on(<span class="st"
	>'</span
	><span class="ch"
	>end'</span
	>, <span class="kw"
	>function</span
	>() {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>losing'</span
	>);<br
	 />});<br
	 /></code
      ></pre
    ></div
  ><div id="&#1074;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1099;&#1077;-&#1079;&#1072;&#1084;&#1099;&#1082;&#1072;&#1085;&#1080;&#1103;"
  ><h2
    ><a href="#TOC"
      >Вложенные замыкания</a
      ></h2
    ><p
    >Не используйте вложенные замыкания. Иначе ваш код превратится в кашу</p
    ><p
    ><em
      >Хорошо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="dt"
	>setTimeout</span
	>(<span class="kw"
	>function</span
	>() {<br
	 />&#160;&#160;client.connect(afterConnect);<br
	 />}, <span class="dv"
	>1000</span
	>);<br
	 /><br
	 /><span class="kw"
	>function</span
	> afterConnect() {<br
	 />&#160;&#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>winning'</span
	>);<br
	 />}<br
	 /></code
      ></pre
    ><p
    ><em
      >Плохо:</em
      ></p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="dt"
	>setTimeout</span
	>(<span class="kw"
	>function</span
	>() {<br
	 />&#160;&#160;client.connect(<span class="kw"
	>function</span
	>() {<br
	 />&#160;&#160; &#160;console.<span class="kw"
	>log</span
	>(<span class="st"
	>'</span
	><span class="ch"
	>losing'</span
	>);<br
	 />&#160;&#160;});<br
	 />}, <span class="dv"
	>1000</span
	>);<br
	 /></code
      ></pre
    ></div
  ><div id="&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;-&#1086;&#1073;&#1088;&#1072;&#1090;&#1085;&#1086;&#1075;&#1086;-&#1074;&#1099;&#1079;&#1086;&#1074;&#1072;-callbacks"
  ><h2
    ><a href="#TOC"
      >Функции обратного вызова (callbacks)</a
      ></h2
    ><p
    >Так как node.js прежде всего сосредоточен на неблокирующем вводе/выводе, то функции в основном возвращают свой результат используя callback'и. В ядре node.js принято соглашение, что первый параметр любого callback'а всегда является необязательным объектом-ошибкой (error object).</p
    ><p
    >Вам так же следует пользоваться этим подходом для ваших callback'ов.</p
    ></div
  ><div id="object.freeze-object.preventextensions-object.seal-with-eval"
  ><h2
    ><a href="#TOC"
      >Object.freeze, Object.preventExtensions, Object.seal, with, eval</a
      ></h2
    ><p
    >Абсолютное безумие, которое, вероятно, никогда вами не будет использовано. Держитесь от этого дела подальше.</p
    ></div
  ><div id="getter&#1099;-&#1080;-setter&#1099;"
  ><h2
    ><a href="#TOC"
      >Getter'ы и setter'ы</a
      ></h2
    ><p
    >Не используйте setter'ы. У людей, которые будут пытаться использовать ваш код, они обязательно вызовут массу проблем.</p
    ><p
    >Getter'ы же - напротив, можно совершенно спокойно использовать в своем коде. Так как они являются чистыми функциями и свободны от <a href="http://en.wikipedia.org/wiki/Side_effect_(computer_science)"
      >побочных эффектов</a
      > (<a href="http://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D0%B1%D0%BE%D1%87%D0%BD%D1%8B%D0%B9_%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)"
      >рус</a
      >). Типовым примером является предоставление свойтсва длины для класса коллекции.</p
    ></div
  ><div id="eventemitter&#1099;"
  ><h2
    ><a href="#TOC"
      >EventEmitter'ы</a
      ></h2
    ><p
    >Node.js включает в себя среди прочего простой класс EventEmitter, который может быть подключен из модуля 'events':</p
    ><pre class="sourceCode javascript"
    ><code
      ><span class="kw"
	>var</span
	> EventEmitter = require(<span class="st"
	>'</span
	><span class="ch"
	>events'</span
	>).EventEmitter;<br
	 /></code
      ></pre
    ><p
    >При создании классов, которые должны поддерживать события, их обычно наследуют от этого класса EventEmitter. В основном это простая реализация <a href="http://en.wikipedia.org/wiki/Observer_pattern"
      >шаблона Observer</a
      > (<a href="http://ru.wikipedia.org/wiki/%D0%9D%D0%B0%D0%B1%D0%BB%D1%8E%D0%B4%D0%B0%D1%82%D0%B5%D0%BB%D1%8C_(%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F)"
      >рус</a
      >)</p
    ><p
    >Однако, я настоятельно не рекомендую слушать события объекта изнутри самого объекта. Это не естественно: слушать самого себя. Зачастую, это ведет к нежелательному открытию деталей реализации и усложнению сопровождения кода.</p
    ></div
  ><div id="&#1085;&#1072;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;-&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1085;&#1086;-&#1086;&#1088;&#1080;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1086;&#1077;-&#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1080;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;"
  ><h2
    ><a href="#TOC"
      >Наследование / Объектно-ориентированное програмиирование</a
      ></h2
    ><p
    >Наследование и объектно-ориентированное програмиирование являются обширными темами. Если вы интересуетесь этими популярными подходами программирования, то почитатйте, пожалуйста, мое <a href="object_oriented_programming.html"
      >Руководство по объектно-ориентированному программированию</a
      >.</p
    ></div
  ></div
>
